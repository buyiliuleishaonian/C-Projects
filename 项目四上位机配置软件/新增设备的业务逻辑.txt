设备管理模块

一、新增设备的业务逻辑

1、数据验证
2、封装数据
3、保存数据

【1】如果是新增
【1.1】设备名称重复性验证
【1.2】插入数据到数据库
【1.3】返回实体对象
【1.4】主窗体同步显示内容

【2】如果是修改怎么办
【2.1】判断修改设备名是否存在
【2.2】修改数据库
【2.3】返回数据
【2.4】主窗体同步显示

4、在主窗体同步显示


二、根据项目，同步显示设备列表
1、从数据库，根据ProjectID，查询所有的设备信息

2、现实的时候，首先要把三种不同的设备列表分集合存储

3、所用的事件，就是当用户选择dgv_Project的所选择SelectionChanged的改变来触发事件

三、根据Project查询设备信息列表的实现逻辑

1、3表 联合查询，EquipmentType，ProtocoType，EquipMents

2、将查询结果根据不同的设备类型ID，分装到集合中

3、通过Dictionary来返回不同的集合


四、修改设备信息
1、使用：通过右键菜单《修改设备》完成

2、特点：从《以太网》《串口》《OPC》三种设备类型集合中修改对象

3、设备集合List<EquipMents>:
索引，对象
0  设备对象1
1 设备对象2
......

4 实现步骤（套路）
【1】根据不同的设备类型，找到要修改的EquipMentID
【2】根据ID，从对应的EquipMents表中，找到设备对象
【3】把要修改的设备对象，传递到窗体中（其他信息同时传递）
【4】在修改窗体中，显示设备对象信息（动态开启输入控件组）
【5】提交修改到数据
.....
【6】修改成功，返回修改后的对象，并同时在FrmMain中刷新显示


5、删除设备类型
1、在DAL中实现删除
实现根据，设备类型ID来删除设备对象
2、在UI中实现删除思路
【1】在当前要删除的dgv所对应的List集合中找到对象
【2】从数据库中删除
【3】从List集合中删除，更新显示

一个项目——N个设备，一个设备——N个通信组，一个通信组——N个变量，这样删除一个设备，所有的都要删除（在数据库中是，不可以删除的，有些是父子键关系）

级联删除（后面继续强调）






